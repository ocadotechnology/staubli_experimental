<?xml version="1.0" encoding="utf-8" ?>
<Programs xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.staubli.com/robotics/VAL3/Program/2" >
  <Program name="recvTrajPt" access="public" >
    <Parameters xmlns="http://www.staubli.com/robotics/VAL3/Param/1" >
      <Parameter name="x_bFlag" type="bool" use="reference" xsi:type="element" dimensions="1" />
    </Parameters>
    <Code><![CDATA[begin
  // attempt to receive message ID 11 data (prefix and header are in rosGenericMsg)
  rosTrajPtMsg.prefix.nLength=rosGenericMsg.prefix.nLength
  rosTrajPtMsg.header.nMsgType=rosGenericMsg.header.nMsgType
  rosTrajPtMsg.header.nCommType=rosGenericMsg.header.nCommType
  rosTrajPtMsg.header.nReplyCode=rosGenericMsg.header.nReplyCode

  call recvData(siTcpIpMotion,rosTrajPtMsg.body.nData,nDataIn,x_bFlag)


  //  // receive message ID 11 data (prefix and header are in rosGenericMsg)
  //  l_nBytesRecv = 0
  //  l_nIndex = 0
  //  
  //  rosTrajPtMsg.prefix.nLength = rosGenericMsg.prefix.nLength
  //  rosTrajPtMsg.header.nMsgType = rosGenericMsg.header.nMsgType
  //  rosTrajPtMsg.header.nCommType = rosGenericMsg.header.nCommType
  //  rosTrajPtMsg.header.nReplyCode = rosGenericMsg.header.nReplyCode
  //  
  //  //while (l_nBytesRecv < (rosGenericMsg.prefix.nLength - 12))
  //  while (l_nBytesRecv < 52)
  //    l_nIndex = sioGet(siTcpIpMotion, l_nByte)
  //    if (l_nIndex == -1)
  //      if (l_nBytesRecv == 0)
  //        // 11000: client is not connected?
  //        if (nDataIn == 1)
  //          nDataIn = -1
  //        endIf
  //      else
  //        // 11000: connection lost
  //        if (nDataIn == 1)
  //          nDataIn = -1
  //        endIf
  //      endIf
  //      bValidMsgBody = false
  //      return
  //    elseIf (l_nIndex == 1)
  //      rosTrajPtMsg.body.nData[l_nBytesRecv] = l_nByte
  //      l_nBytesRecv = l_nBytesRecv + l_nIndex
  //      nDataIn = 1
  //    endIf
  //  endWhile
  //  bValidMsgBody = true
end]]></Code>
  </Program>
</Programs>