<?xml version="1.0" encoding="utf-8"?>
<Programs xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.staubli.com/robotics/VAL3/Program/2">
  <Program name="screenUpdate" access="public">
    <Code><![CDATA[begin
  userPage(scMonitor)
  cls(scMonitor)
  title(scMonitor, "ROS-I server")
  
  while (true)
    // clear screen
    cls(scMonitor)
    
    // update connection status on port 11000
    gotoxy(scMonitor, 0,0)
    // 11 characteres: gotoxy(12,0) to insert status
    put(scMonitor, "Port 11000:")
    gotoxy(scMonitor, 12,0)
    switch nDataIn
      case -1
        put(scMonitor, "connection lost")
      break
      case 0
        put(scMonitor, "not connected")
      break
      case 1
        put(scMonitor, "connected")
      break
      default
        put(scMonitor, "not connected")
      break
    endSwitch
    
    // update connection status on port 11002
    gotoxy(scMonitor, 0,1)
    // 11 characteres: gotoxy(12,1) to insert status
    put(scMonitor, "Port 11002:")
    gotoxy(scMonitor, 12,1)
    switch nDataOut
      case -1
        put(scMonitor, "connection lost")
      break
      case 0
        put(scMonitor, "not connected")
      break
      case 1
        put(scMonitor, "connected")
      break
      default
        put(scMonitor, "not connected")
      break
    endSwitch
    
    // update trajectory buffer size
    gotoxy(scMonitor, 0,3)
    // 18 characteres: gotoxy(19,3) to insert status
    put(scMonitor, "Trajectory buffer:")
    gotoxy(scMonitor, 19,3)
    put(scMonitor, libTrajPtBuffer:nElems)
    // also print number of points popped from buffer
    gotoxy(scMonitor, 24,3)
    put(scMonitor, nPtsPopped)
    // do the same for move buffer
    gotoxy(scMonitor, 0,4)
    put(scMonitor, "Motion buffer:")
    gotoxy(scMonitor, 19,4)
    put(scMonitor, libMoveBuffer:nElems)
    gotoxy(scMonitor, 24,4)
    put(scMonitor, nMovePts)
    
    // display nMoveId and nMotionProgress
    gotoxy(scMonitor, 0,6)
    put(scMonitor, "moveId:")
    gotoxy(scMonitor, 8,6)
    put(scMonitor, nMoveId)
    gotoxy(scMonitor, 13,6)
    put(scMonitor, "progress:")
    gotoxy(scMonitor, 23,6)
    put(scMonitor, nMotionProgress)
    
    // display heartbeat status
    gotoxy(scMonitor, 0,8)
    put(scMonitor, "Heartbeat status:")
    gotoxy(scMonitor, 18,8)
    put(scMonitor, nDataOut)
    
    // update debug status
    gotoxy(scMonitor, 18,10)
    switch nDebugStatus
      case 0
        put(scMonitor, "[+]")
        nDebugStatus = 1
      break
      case 1
        put(scMonitor, "[-]")
        nDebugStatus = 0
      break
      default
      break
    endSwitch
    
    // sequence task
    //delay(0)
    delay(0.5)
  endWhile
end]]></Code>
  </Program>
</Programs>